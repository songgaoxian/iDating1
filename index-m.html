<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<link rel="shortcut icon" href="img/icon.png">
<link rel="stylesheet" type="text/CSS" href="shared-frame-m.css">
<link rel="stylesheet" type="text/CSS" href="pink-theme.css">
<link rel="stylesheet" type="text/CSS" href="index-m.css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>
$(document).ready(function() {
	    //show sign in box, hide sign up box
    $("#tab-signin").click(function() {
		$("#tab-signup").removeClass("colored-txt-dark")
		$(this).addClass("colored-txt-dark");
		$("#signup-form").hide();
	    $("#signin-form").fadeIn();
	});
	
	//show sign up box, hide sign in box
	$("#tab-signup").click(function() {
		$("#tab-signin").removeClass("colored-txt-dark")
		$(this).addClass("colored-txt-dark");
		$("#signin-form").hide();
	    $("#signup-form").fadeIn();
	});
	
	//show forget password box
	$("#forget-link").click(function() {
		$("#tabs").hide();
		$("#signin-form").hide();
	    $("#forget-form").fadeIn();
	});
	
	//hide forget password box
	$("#forget-back").click(function() {
		$("#tabs").show();
		 $("#signin-form").fadeIn();
	    $("#forget-form").hide();
	});	
});
</script>
<title>Welcome to iDating</title>
</head>

<body>
<!--header-start-->
<div class="header">
<img src="img/logo_small.png" alt="iDating logo">
</div>
<!--header-end-->

<!--container-start-->
<div class="container">
<div id="banner" class="background-cover-center"></div>
<!--sign-box-start-->
<div id="sign-box">
<div id="tabs">
<button id="tab-signup" class="link-btn no-line colored-txt-dark" type="button">Sign Up</button>|
<button id="tab-signin" class="link-btn no-line" type="button">Sign In</button>
</div>

<form id="signup-form">
<input id="email-adr" class="txtbox txtbox-fill"  type="email" placeholder="Your Email" name="email" required><br>
<input id="pwd" class="txtbox txtbox-fill" type="password" placeholder="Your Password" name="password" required><br>
<input id="pwd-confirm" class="txtbox txtbox-fill" type="password" placeholder="Enter Password Again" name="password-confirm" required><br>
<button id="signup" class="btn btn-fill" onclick="logup()" type="button">SIGN UP NOW</button>
</form>

<form id="signin-form">
<input id="email-adr-2" class="txtbox txtbox-fill"  type="email" placeholder="Your Email" name="email" required><br>
<input id="pwd-2" class="txtbox txtbox-fill" type="password" placeholder="Your Password" name="password" required><br>
<button id="forget-link"  class="link-btn"  type="button">Forget your password?</button>
<button id="signin" class="btn btn-fill" onclick="login()" type="button">SIGN IN</button>
</form>

<form id="forget-form" action="forget.php" method="post">
Please enter your email address:
<input id="email-adr-3" class="txtbox txtbox-fill"  type="email" placeholder="Your Email" name="email" required><br><br>
A randomly generated password will be sent to you after verification. You can modify it later on.<br>
<button id="forget-back" class="btn btn-fill" type="button" >Back</button>
<input id="forget-send" class="btn btn-fill"  type="submit" value="Send Email">
</form>
</div>
<!--sign-box-end-->
</div>
<!--container-end-->

<!--footer-start-->
<div>
<p id="footer">&copy; 2015 All Rights Reserved.</p>
</div>
<!--footer-end-->

<script>
var record;
function logup(){
	var email=document.getElementById("email-adr").value.trim();
	var pwd=document.getElementById("pwd").value;
	var pwd1=document.getElementById("pwd-confirm").value;
	if(email.length==0 || pwd.length==0){return;}
	else if(!(pwd==pwd1)){alert("passwords should be the same!");}
	else{
		xmlhttp=new XMLHttpRequest(); 
			//may be not secure......
		content='{"email":"'+email+'","password":"'+pwd+'"}';
		xmlhttp.open("POST","logup.php",false);
		xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
		xmlhttp.send(content);
	//get response from login.php
		console.log(xmlhttp);
		record=xmlhttp;
		response=JSON.parse(xmlhttp.response);
		if(response['check']=='true'){
			window.location='registration-m.php?sid='+response['sid'];
		}
		else if(response['check']=='false'){
			//error message needs modification
			alert("Email or password is wrong!");
		}
		else{
			//if !$conn in login.php
			alert("System is busy. Please try again!");
		}
	}
}
function login(){
//get login information from user input
	var email=document.getElementById("email-adr-2").value.trim();
		//can input password be contraint without ' '?
	var pwd=document.getElementById("pwd-2").value;
//check whether empty, error message needs modification
	if(email.length==0 || pwd.length==0){alert("Input should not be empty!");}
	else{
	//create xmlHttpRequest and send info to login.php
		xmlhttp=new XMLHttpRequest(); 
			//may be not secure......
		content='{"email":"'+email+'","password":"'+pwd+'"}';
		xmlhttp.open("POST","login.php",false);
		xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
		xmlhttp.send(content);
	//get response from login.php
		console.log(xmlhttp);
		record=xmlhttp;
		response=JSON.parse(xmlhttp.response);
		if(response['check']=='true'){
			console.log('accountmgt-m.php?sid='+response['sid']);
			window.location='accountmgt-m.php?sid='+response['sid'];
		}
		else if(response['check']=='false'){
			//error message needs modification
			alert("Email or password is wrong!");
		}
		else{
			//if !$conn in login.php
			alert("System is busy. Please try again!");
		}
	}
}
</script>
</body>
</html>
